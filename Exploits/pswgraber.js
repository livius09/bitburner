/** @param {NS} ns */
async function throweror(ns,code){
  ns.tprint(code);
  ns.kill(ns.pid())
}

export async function main(ns) {
  if(!ns.fileExists("psw.txt")){
    throweror(ns,"psw.txt does not exist")
  }else{
    let pswtxt= ns.read("psw.txt");
    var paswords= pswtxt.split(",");
  }
  if (!ns.fileExists("user.txt")){
    throweror(ns,"user.txt does not exist");
  }else{
    let userstxt = ns.read("user.txt");
    var users = userstxt.split(",")
  }
  if (!ns.fileExists("auth.txt")){
    throweror(ns,"auth.txt doese not exist")
  }else{
    let authtxt = ns.read("auth.txt");
    var authlevel = authtxt.split(",");
  }

  //let bestauth = Math.min(authlevel);
  var id = authlevel.indexOf("0");

  var usermane = users[id];
  var pasword = paswords[id];
  
  ns.writePort(10,"login");
  ns.tprint("initiated login")
  await ns.sleep(1100);
  ns.writePort(10,usermane);
  ns.tprint("wrote username: "+usermane);
  await ns.sleep(250);
  ns.writePort(10,pasword);
  ns.tprint("wrote pasword: "+pasword);
  await ns.sleep(250);
}
